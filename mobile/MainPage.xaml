<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="PS5UploadMobile.MainPage"
             Title="PS5 Upload Suite">

    <Grid RowDefinitions="Auto,Auto,Auto,*,Auto,Auto">
        
        <!-- Top Bar with Menu -->
        <Grid Grid.Row="0" Padding="10" BackgroundColor="#1E1E1E" ColumnDefinitions="Auto,*,Auto">
            <Button Grid.Column="0" Text="☰" FontSize="24" BackgroundColor="Transparent" 
                    Clicked="OnMenuClicked" WidthRequest="50"/>
            <Label Grid.Column="1" Text="PS5 Upload Suite" FontSize="20" FontAttributes="Bold" 
                   TextColor="White" VerticalOptions="Center" HorizontalOptions="Center"/>
            <Button Grid.Column="2" Text="⭐" FontSize="20" BackgroundColor="Transparent" 
                    Clicked="OnAddFavoriteClicked" WidthRequest="50"/>
        </Grid>
        
        <!-- Connection Panel -->
        <Frame Grid.Row="1" Padding="10" Margin="10,5,10,5" BackgroundColor="#1E1E1E" CornerRadius="8">
            <VerticalStackLayout Spacing="10">
                <Label Text="PS5 Connection" FontSize="18" FontAttributes="Bold" TextColor="White"/>
                
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Entry x:Name="IpEntry" Grid.Column="0" Placeholder="PS5 IP (192.168.0.160)" 
                           Text="192.168.0.160" TextColor="White" PlaceholderColor="Gray"/>
                    <Entry x:Name="PortEntry" Grid.Column="1" Placeholder="Port (9113)" 
                           Text="9113" Keyboard="Numeric" TextColor="White" PlaceholderColor="Gray"/>
                </Grid>
                
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button x:Name="ConnectBtn" Grid.Column="0" Text="Connect" 
                            Clicked="OnConnectClicked" BackgroundColor="#0078D4"/>
                    <Button x:Name="DisconnectBtn" Grid.Column="1" Text="Disconnect" 
                            Clicked="OnDisconnectClicked" BackgroundColor="#D13438" IsEnabled="False"/>
                </Grid>
                
                <Label x:Name="StatusLabel" Text="Not connected" FontSize="12" 
                       TextColor="Orange" HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Frame>

        <!-- Path Navigation -->
        <Frame Grid.Row="2" Padding="10" Margin="10,0,10,5" BackgroundColor="#2D2D2D" CornerRadius="8">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <Button Grid.Column="0" Text="⬆️" Clicked="OnUpDirectoryClicked" 
                        WidthRequest="50" BackgroundColor="#3E3E3E"/>
                <Entry x:Name="PathEntry" Grid.Column="1" Text="/data/" 
                       TextColor="White" Margin="10,0"/>
                <Button Grid.Column="2" Text="🔄" Clicked="OnRefreshClicked" 
                        WidthRequest="50" BackgroundColor="#3E3E3E"/>
            </Grid>
        </Frame>

        <!-- File List -->
        <Frame Grid.Row="3" Padding="0" Margin="10,0,10,5" BackgroundColor="#2D2D2D" CornerRadius="8">
            <CollectionView x:Name="FileListView" SelectionMode="Single" 
                            SelectionChanged="OnFileSelected">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="15,10" ColumnDefinitions="Auto,*,Auto">
                            <Label Grid.Column="0" Text="{Binding Icon}" FontSize="20" 
                                   VerticalOptions="Center" Margin="0,0,10,0"/>
                            <VerticalStackLayout Grid.Column="1" VerticalOptions="Center">
                                <Label Text="{Binding Name}" TextColor="White" FontSize="16"/>
                                <Label Text="{Binding Size}" TextColor="Gray" FontSize="12"/>
                            </VerticalStackLayout>
                            <Label Grid.Column="2" Text="{Binding Type}" TextColor="Gray" 
                                   FontSize="12" VerticalOptions="Center"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Frame>

        <!-- Progress Bar -->
        <Frame Grid.Row="4" Padding="10" Margin="10,0,10,5" BackgroundColor="#2D2D2D" 
               CornerRadius="8" IsVisible="{Binding IsTransferring}">
            <VerticalStackLayout Spacing="5">
                <Label x:Name="ProgressLabel" Text="Uploading..." TextColor="White" FontSize="14"/>
                <ProgressBar x:Name="ProgressBar" Progress="0" ProgressColor="#0078D4"/>
                <Label x:Name="ProgressPercentLabel" Text="0%" TextColor="Gray" 
                       FontSize="12" HorizontalOptions="Center"/>
            </VerticalStackLayout>
        </Frame>

        <!-- Action Buttons -->
        <Grid Grid.Row="5" Padding="10" ColumnDefinitions="*,*,*" ColumnSpacing="10">
            <Button Grid.Column="0" Text="📤 Upload" Clicked="OnUploadClicked" 
                    BackgroundColor="#107C10"/>
            <Button Grid.Column="1" Text="📥 Download" Clicked="OnDownloadClicked" 
                    BackgroundColor="#0078D4"/>
            <Button Grid.Column="2" Text="🗑️ Delete" Clicked="OnDeleteClicked" 
                    BackgroundColor="#D13438"/>
        </Grid>
    </Grid>

</ContentPage>
